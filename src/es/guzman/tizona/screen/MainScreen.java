package es.guzman.tizona.screen;

import org.vaadin.jouni.animator.AnimatorProxy;
import org.vaadin.jouni.animator.client.ui.VAnimatorProxy.AnimType;

import com.vaadin.annotations.AutoGenerated;
import com.vaadin.terminal.Sizeable;
import com.vaadin.terminal.gwt.client.ui.AlignmentInfo.Bits;
import com.vaadin.ui.AbsoluteLayout;
import com.vaadin.ui.Alignment;
import com.vaadin.ui.Button;
import com.vaadin.ui.Button.ClickEvent;
import com.vaadin.ui.Button.ClickListener;
import com.vaadin.ui.Component;
import com.vaadin.ui.CustomComponent;
import com.vaadin.ui.GridLayout;
import com.vaadin.ui.VerticalSplitPanel;

import es.guzman.tizona.common.StringsContainer;

public class MainScreen extends CustomComponent {

    @AutoGenerated
    private AbsoluteLayout mainLayout;

    @AutoGenerated
    private VerticalSplitPanel verticalSplitPanelPrincipal;

    /*- VaadinEditorProperties={"grid":"RegularGrid,20","showGrid":true,"snapToGrid":true,"snapToObject":true,"movingGuides":false,"snappingDistance":10} */

    // Common objects
    private AnimatorProxy proxy = new AnimatorProxy();

    /**
     * The constructor should first build the main layout, set the composition
     * root and then do any custom initialization.
     * 
     * The constructor will not be automatically regenerated by the visual
     * editor.
     */
    public MainScreen() {
	buildMainLayout();
	setCompositionRoot(mainLayout);

	// Initialize the "effects proxy"
	mainLayout.addComponent(proxy);
	
	// Configuraci√≥n del panel principal
	verticalSplitPanelPrincipal.setLocked(true);
	verticalSplitPanelPrincipal.setSplitPosition(50,
                Sizeable.UNITS_PIXELS);

	// Creamos la cabecera
	Component cabecera = hazCabecera();
	verticalSplitPanelPrincipal.setFirstComponent(cabecera);
	proxy.animate(cabecera, AnimType.FADE_IN).setDuration(300).setDelay(0);
	
    }

    @AutoGenerated
    private AbsoluteLayout buildMainLayout() {
	// common part: create layout
	mainLayout = new AbsoluteLayout();
	mainLayout.setImmediate(false);
	mainLayout.setWidth("100%");
	mainLayout.setHeight("100%");
	mainLayout.setMargin(false);
	
	// top-level component properties
	setWidth("100.0%");
	setHeight("100.0%");
	
	// verticalSplitPanelPrincipal
	verticalSplitPanelPrincipal = new VerticalSplitPanel();
	verticalSplitPanelPrincipal.setImmediate(false);
	verticalSplitPanelPrincipal.setWidth("100.0%");
	verticalSplitPanelPrincipal.setHeight("100.0%");
	verticalSplitPanelPrincipal.setMargin(false);
	mainLayout.addComponent(verticalSplitPanelPrincipal, "top:0.0px;left:0.0px;");
	
	return mainLayout;
    }

    private Component hazCabecera() {
	
	GridLayout grid = new GridLayout(3,1);
	grid.setStyleName("principal-cabecera-grid");
	grid.setSpacing(true);
	grid.setMargin(true);
	grid.setWidth("100%");
	grid.setHeight("100%");
	
//	grid.addStyleName(style)
	
	Button botonSalir = new Button(StringsContainer.getString("tizona.principal.logout"));
	botonSalir.addStyleName("principal-cabecera-salir");
	botonSalir.addListener(new ClickListener() {
	    @Override
	    public void buttonClick(ClickEvent event) {       
		doLogout();
	    }
	});
	grid.addComponent(botonSalir, 0, 0);
	grid.setComponentAlignment(botonSalir, new Alignment(Bits.ALIGNMENT_VERTICAL_CENTER
		| Bits.ALIGNMENT_LEFT));
	
	return grid;
	
    }
    
    private void doLogout() { 
	getApplication().close();
    }
    
}
